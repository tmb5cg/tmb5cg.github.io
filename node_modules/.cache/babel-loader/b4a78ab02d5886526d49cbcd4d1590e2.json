{"ast":null,"code":"var _jsxFileName = \"/Users/tucker/Documents/GitHub/tmb5cg.github.io/src/components/FreeTimeFinder/CalendarOutput.js\";\nimport React from 'react';\nimport Calendar from './Calendar.js';\nimport format from \"date-fns/format\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst CalendarOutput = props => {\n  const allStartTimes = [];\n  const allEndTimes = [];\n  const busyBlocksToAdd = [];\n\n  const fetchTest = () => {\n    // Format start date to 8am\n    var start = new Date(props.startDate);\n    start.setHours(8);\n    start.setMinutes(0);\n    start.setSeconds(0);\n    start = start.toISOString(); // Format end date to 8 pm\n\n    var end = new Date(props.startDate);\n    end.setHours(20);\n    end.setMinutes(0);\n    end.setSeconds(0);\n    end = end.toISOString();\n    console.log(start);\n    console.log(end); // Build request body\n\n    const request = {};\n    request.timeMin = start;\n    request.timeMax = end;\n    request.timeZone = \"EST\"; // Create calendars object\n\n    let cals = [];\n\n    for (let i = 0; i < props.selectedCalendars.length; i++) {\n      let calObj = {};\n      calObj.id = props.selectedCalendars[i];\n      cals.push(calObj);\n    }\n\n    request.items = cals;\n    let num_days = props.endDate.getDate() - props.startDate.getDate(); // for each day in between input dates, add event\n    // day1 8am 830am, 8pm to day2 8am\n\n    for (let x = 0; x < num_days; x++) {\n      day = props.startDate.getDate();\n      curDateDay = day + x;\n      inputDate = props.startDate; //appendPre(curDateDay)\n\n      morningBusyStart = new Date();\n      morningBusyStart.setDate(curDateDay);\n      morningBusyStart.setHours(8);\n      morningBusyStart.setMinutes(0);\n      morningBusyStart.setSeconds(0);\n      morningBusyStart.setFullYear(inputDate.getFullYear());\n      morningBusyEnd = new Date();\n      morningBusyEnd.setDate(curDateDay);\n      morningBusyEnd.setHours(8);\n      morningBusyEnd.setMinutes(30);\n      morningBusyEnd.setSeconds(0);\n      morningBusyEnd.setFullYear(inputDate.getFullYear());\n      nightBusyStart = new Date();\n      nightBusyStart.setDate(curDateDay);\n      nightBusyStart.setHours(20);\n      nightBusyStart.setMinutes(0);\n      nightBusyStart.setSeconds(0);\n      nightBusyStart.setFullYear(inputDate.getFullYear());\n      nightBusyEnd = new Date();\n      nightBusyEnd.setDate(curDateDay);\n      nightBusyEnd.setHours(20);\n      nightBusyEnd.setMinutes(30);\n      nightBusyEnd.setSeconds(0);\n      nightBusyEnd.setFullYear(inputDate.getFullYear()); // prettyStartTime = morningBusyStart.toLocaleString('en-US', { timeZone: 'EST' });\n      // prettyEndTime = morningBusyEnd.toLocaleString('en-US', { timeZone: 'EST' });\n\n      var morningBusyStart_formatted = {\n        date: morningBusyStart\n      };\n      var morningBusyEnd_formatted = {\n        date: morningBusyEnd\n      };\n      var nightBusyStart_formatted = {\n        date: nightBusyStart\n      };\n      var nightBusyEnd_formatted = {\n        date: nightBusyEnd\n      };\n      allStartTimes.push(morningBusyStart_formatted);\n      allEndTimes.push(morningBusyEnd_formatted);\n      allStartTimes.push(nightBusyStart_formatted);\n      allEndTimes.push(nightBusyEnd_formatted);\n      timecombo = [morningBusyStart, morningBusyEnd];\n      busyBlocksToAdd.push(timecombo);\n    }\n\n    return freeRequest = gapi.client.calendar.freebusy.query(request).then(function (response) {\n      console.log(\"Frebusy response: \", response);\n      console.log(\"Frebusy response2: \", response.result);\n\n      for (let k = 0; k < props.selectedCalendars.length; k++) {\n        var curCal = props.selectedCalendars[k];\n        console.log(\"Current calendar: \", curCal);\n        console.log(\"Iteration: k = \" + k);\n        var busyTimes = response.result.calendars[curCal].busy;\n\n        for (let i = 0; i < busyTimes.length; i++) {\n          var busyBlock = busyTimes[i];\n          console.log(\"Busy block for \" + curCal, busyBlock);\n          var startTime = busyBlock.start;\n          var endTime = busyBlock.end;\n          var data = {\n            date: startTime\n          };\n          var data2 = {\n            date: endTime\n          };\n          allStartTimes.push(data);\n          allEndTimes.push(data2);\n        }\n      }\n\n      consolidateAllBusyTimes(); // console.log(allStartTimes)\n      // console.log(allEndTimes)\n      // console.log(busyBlocksToAdd)\n    }, function (err) {\n      console.error(\"Execute error\", err);\n    });\n  };\n\n  const consolidateAllBusyTimes = () => {\n    allStartTimes.sort(function (a, b) {\n      var c = new Date(a.date);\n      var d = new Date(b.date);\n      return c - d;\n    }); //    appendPre(\"- - - - - - - Sorting end times\")\n\n    allEndTimes.sort(function (a, b) {\n      var c = new Date(a.date);\n      var d = new Date(b.date);\n      return c - d;\n    });\n    let startTimes = allStartTimes;\n    let endTimes = allEndTimes;\n    var masterArray = [];\n\n    for (let x = 0; x < startTimes.length; x++) {\n      let startTime = startTimes[x].date;\n      let endTime = endTimes[x].date;\n      let timeStartDateFormat = new Date(startTime);\n      let timeEndDateFormat = new Date(endTime);\n      let prettyStartTime = timeStartDateFormat.toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n      let prettyEndTime = timeEndDateFormat.toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n      let timecombo = [timeStartDateFormat, timeEndDateFormat];\n      masterArray.push(timecombo);\n    } // print OG array\n    // // //\n\n\n    console.log(\"Original array\");\n\n    for (let k = 0; k < masterArray.length; k++) {\n      let data = masterArray[k];\n      let start = data[0];\n      let end = data[1];\n      let start2 = new Date(start).toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n      let end2 = new Date(end).toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n      console.log(k + \" Start: \" + start2 + \" || End: \" + end2);\n    } // STEP 1 merge all same start times\n\n\n    var newtimes = [];\n\n    for (let x = 0; x < masterArray.length; x++) {\n      var data = masterArray[x];\n      var curstart = data[0].getTime();\n      var curend = data[1].getTime();\n      var latestend = curend;\n\n      for (let i = 0; i < masterArray.length; i++) {\n        var data2 = masterArray[i];\n        var start2 = data2[0].getTime();\n        var end2 = data2[1].getTime();\n\n        if (curstart == start2) {\n          if (latestend < end2) {\n            latestend = end2;\n          }\n        }\n      }\n\n      let newtime = [curstart, latestend];\n      var shouldWeAddIt = true;\n\n      for (let k = 0; k < newtimes.length; k++) {\n        let data = newtimes[k];\n        let start = data[0];\n        let end = data[1];\n\n        if (start == curstart) {\n          if (end == latestend) {\n            shouldWeAddIt = false;\n          }\n        } else {}\n      }\n\n      if (shouldWeAddIt) {\n        newtimes.push(newtime);\n      }\n    } // print OG array\n    //\n    //  appendPre(\"Merging same start times\");\n\n\n    for (let k = 0; k < newtimes.length; k++) {\n      let data = newtimes[k];\n      let start = data[0];\n      let end = data[1];\n      start2 = new Date(start).toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n      end2 = new Date(end).toLocaleString('en-US', {\n        timeZone: 'EST'\n      }); //appendPre(k + \" Start: \" + start2 + \" || End: \" + end2);\n    } // STEP 2  Remove times within larger time blocks\n\n\n    var newertimes = [];\n\n    for (let x = 0; x < newtimes.length; x++) {\n      var data = newtimes[x];\n      var curstart = data[0];\n      var curend = data[1];\n      var latestend = curend;\n      var shouldAdd = true;\n\n      for (let i = 0; i < newtimes.length; i++) {\n        var data2 = newtimes[i];\n        var start2 = data2[0];\n        var end2 = data2[1];\n\n        if (start2 < curstart) {\n          if (end2 > curend) {\n            shouldAdd = false;\n          }\n        }\n      }\n\n      let newtime = [curstart, curend];\n\n      if (shouldAdd) {\n        newertimes.push(newtime);\n      }\n    } // STEP 2 printing results\n    //  appendPre(\"TIMES WITH OVERLAPPING BLOCKS REMOVED: \" + newertimes);\n\n\n    for (let k = 0; k < newertimes.length; k++) {\n      data = newertimes[k];\n      let start = data[0];\n      let end = data[1];\n      let start2 = new Date(start).toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n      let end2 = new Date(end).toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n    } // STEP  3 FINAL STEP - consolidate back to back events\n\n\n    var newesttimes = [];\n    var removedtimes = [];\n\n    for (let x = 0; x < newertimes.length; x++) {\n      var data = newertimes[x];\n      var curstart = data[0];\n      var curend = data[1];\n\n      for (let i = 0; i < newertimes.length; i++) {\n        var data2 = newertimes[i];\n        var start2 = data2[0];\n        var end2 = data2[1];\n\n        if (curend > start2) {\n          if (curend < end2) {\n            let newtime = [curstart, end2];\n            newesttimes.push(newtime);\n            removedtimes.push([curstart, curend]);\n            removedtimes.push([start2, end2]);\n          }\n        }\n      }\n    } // STEP 3 printing results\n\n\n    for (let k = 0; k < newesttimes.length; k++) {\n      data = newesttimes[k];\n      let start = data[0];\n      let end = data[1];\n      let start2 = new Date(start).toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n      let end2 = new Date(end).toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n    } // more printing results\n\n\n    for (let k = 0; k < removedtimes.length; k++) {\n      data = removedtimes[k];\n      let start = data[0];\n      let end = data[1];\n      let start2 = new Date(start).toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n      let end2 = new Date(end).toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n    } // Adding consolidated times together, finishing up etc\n\n\n    var finaltimes = [];\n\n    for (let k = 0; k < newertimes.length; k++) {\n      data = newertimes[k];\n      let start = data[0];\n      let end = data[1];\n      var shouldWeAddIt = true;\n\n      for (let x = 0; x < removedtimes.length; x++) {\n        let data2 = removedtimes[x];\n        let start2 = data2[0];\n        let end2 = data2[1];\n\n        if (start2 == start) {\n          if (end2 == end) {\n            shouldWeAddIt = false;\n          }\n        }\n      }\n\n      if (shouldWeAddIt == true) {\n        finaltimes.push(data);\n      }\n    }\n\n    for (let k = 0; k < finaltimes.length; k++) {\n      data = finaltimes[k];\n      let start = data[0];\n      let end = data[1];\n      let start2 = new Date(start).toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n      let end2 = new Date(end).toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n    }\n\n    for (let k = 0; k < newesttimes.length; k++) {\n      let data = newesttimes[k];\n      finaltimes.push(data);\n    }\n\n    for (let k = 0; k < finaltimes.length; k++) {\n      data = finaltimes[k];\n      let start = data[0];\n      let end = data[1];\n      let start2 = new Date(start).toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n      let end2 = new Date(end).toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n    }\n\n    var allstarttimes3 = [];\n    var allendtimes3 = [];\n\n    for (let k = 0; k < finaltimes.length; k++) {\n      data = finaltimes[k];\n      let start = data[0];\n      let end = data[1];\n      allstarttimes3.push(start);\n      allendtimes3.push(end);\n    }\n\n    allstarttimes3.sort(function (a, b) {\n      return a - b;\n    });\n    allendtimes3.sort(function (a, b) {\n      return a - b;\n    });\n    var finalmasterArray = [];\n\n    for (let x = 0; x < allstarttimes3.length; x++) {\n      let startTime = allstarttimes3[x];\n      let endTime = allendtimes3[x];\n      let timeStartDateFormat = new Date(startTime);\n      let timeEndDateFormat = new Date(endTime);\n      let prettyStartTime = timeStartDateFormat.toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n      let prettyEndTime = timeEndDateFormat.toLocaleString('en-US', {\n        timeZone: 'EST'\n      });\n      let timecombo = [timeStartDateFormat, timeEndDateFormat];\n      finalmasterArray.push(timecombo);\n    }\n\n    printPrettyTimeslots(allstarttimes3, allendtimes3, finalmasterArray);\n  };\n\n  function printPrettyTimeslots(allstarttimes3, allendtimes3, finalmasterArray) {\n    var awesomeArray = [];\n    let diff = '';\n    let beginfreeslot = '';\n    let endfreeslot = '';\n    let prettyStart = '';\n    let prettyEnd = '';\n    let prettyStartTime = '';\n    let prettyEndTime = '';\n\n    for (let x = 0; x < finalmasterArray.length - 1; x++) {\n      var times = finalmasterArray[x];\n      var curstart = times[0];\n      var curend = times[1];\n      var times = finalmasterArray[x + 1];\n      var nextstart = times[0];\n      var nextend = times[1];\n\n      if (x == 0) {\n        // First element, subtract from 8am\n        let eightAm = new Date(curstart);\n        eightAm.setHours(8);\n        eightAm.setMinutes(0);\n        eightAm.setSeconds(0);\n        eightAm = eightAm.getTime();\n        eightAm = new Date(eightAm);\n        let diff = curstart - eightAm;\n\n        if (diff > 0 && diff < 36000000) {\n          let beginfreeslot = eightAm;\n          eightAm = eightAm.getTime();\n          let endfreeslot = eightAm + diff; // console.log(\"morning begin free slot (should be 8am): \" + beginfreeslot);\n          // console.log(\"morning diff should be 30 mins: \" + diff);\n          //\n          // console.log(\"morning end free slot (should be 830am): \" + endfreeslot);\n\n          let prettyStart = new Date(beginfreeslot);\n          let prettyEnd = new Date(endfreeslot);\n          let prettyStartTime = prettyStart.toLocaleString('en-US', {\n            timeZone: 'EST'\n          });\n          let prettyEndTime = prettyEnd.toLocaleString('en-US', {\n            timeZone: 'EST'\n          });\n          let splitStart = prettyStartTime.split(\" \");\n          let splitEnd = prettyEndTime.split(\" \");\n          let ogStart = splitStart[1];\n          let ogEnd = splitEnd[1];\n          awesomeArray.push([prettyStart, prettyEnd]);\n        } // final else statement is skipped on first element due to bad code\n        // copying and pasting the else so it will hit, then it will\n        // add the end time\n\n\n        diff = nextstart - curend;\n\n        if (diff > 0 && diff < 36000000) {\n          let beginfreeslot = curend;\n          let endfreeslot = nextstart + diff;\n          console.log(\"correct begin free slot: \" + beginfreeslot);\n          console.log(\"correct diff \" + diff);\n          console.log(\"correct end slot: \" + endfreeslot);\n          let prettyStart = new Date(beginfreeslot);\n          let prettyEnd = new Date(endfreeslot);\n          let prettyStartTime = prettyStart.toLocaleString('en-US', {\n            timeZone: 'EST'\n          });\n          let prettyEndTime = prettyEnd.toLocaleString('en-US', {\n            timeZone: 'EST'\n          });\n          let splitStart = prettyStartTime.split(\" \");\n          let splitEnd = prettyEndTime.split(\" \");\n          let ogStart = splitStart[1];\n          let ogEnd = splitEnd[1];\n          awesomeArray.push([prettyStart, prettyEnd]);\n        }\n      } else if (x == finalmasterArray.length - 2) {\n        // final else statement is skipped on last element due to bad code\n        // copying and pasting the else so it will hit, then it will\n        // add the end time\n        diff = nextstart - curend;\n\n        if (diff > 0 && diff < 36000000) {\n          let beginfreeslot = curend;\n          let endfreeslot = nextstart + diff;\n          console.log(\"correct begin free slot: \" + beginfreeslot);\n          console.log(\"correct diff \" + diff);\n          console.log(\"correct end slot: \" + endfreeslot);\n          let prettyStart = new Date(beginfreeslot);\n          let prettyEnd = new Date(endfreeslot);\n          let prettyStartTime = prettyStart.toLocaleString('en-US', {\n            timeZone: 'EST'\n          });\n          let prettyEndTime = prettyEnd.toLocaleString('en-US', {\n            timeZone: 'EST'\n          });\n          let splitStart = prettyStartTime.split(\" \");\n          let splitEnd = prettyEndTime.split(\" \");\n          let ogStart = splitStart[1];\n          let ogEnd = splitEnd[1];\n          awesomeArray.push([prettyStart, prettyEnd]);\n        } // Proceed to add final end of day -> 8 pm time slot\n\n\n        let sevenPm = new Date(curend);\n        sevenPm.setHours(8 + 12);\n        sevenPm.setMinutes(0);\n        sevenPm.setSeconds(0);\n        nextend = nextend.getTime();\n        diff = sevenPm - nextend;\n\n        if (diff > 0 && diff < 36000000) {\n          // nextend = nextend.getTime()\n          beginfreeslot = nextend;\n          endfreeslot = nextend + diff;\n          prettyStart = new Date(beginfreeslot);\n          prettyEnd = new Date(endfreeslot);\n          prettyStartTime = prettyStart.toLocaleString('en-US', {\n            timeZone: 'EST'\n          });\n          prettyEndTime = prettyEnd.toLocaleString('en-US', {\n            timeZone: 'EST'\n          });\n          splitStart = prettyStartTime.split(\" \");\n          splitEnd = prettyEndTime.split(\" \");\n          ogStart = splitStart[1];\n          ogEnd = splitEnd[1];\n          awesomeArray.push([prettyStart, prettyEnd]);\n        }\n      } else {\n        let diff = nextstart - curend;\n\n        if (diff > 0 && diff < 36000000) {\n          beginfreeslot = curend;\n          endfreeslot = nextstart + diff;\n          console.log(\"correct begin free slot: \" + beginfreeslot);\n          console.log(\"correct diff \" + diff);\n          console.log(\"correct end slot: \" + endfreeslot);\n          prettyStart = new Date(beginfreeslot);\n          prettyEnd = new Date(endfreeslot);\n          prettyStartTime = prettyStart.toLocaleString('en-US', {\n            timeZone: 'EST'\n          });\n          prettyEndTime = prettyEnd.toLocaleString('en-US', {\n            timeZone: 'EST'\n          });\n          splitStart = prettyStartTime.split(\" \");\n          splitEnd = prettyEndTime.split(\" \");\n          ogStart = splitStart[1];\n          ogEnd = splitEnd[1];\n          awesomeArray.push([prettyStart, prettyEnd]);\n        }\n      }\n    } // Remove old elements in list\n\n\n    thelist = document.getElementById(\"myList\");\n\n    while (thelist.firstChild) {\n      thelist.removeChild(thelist.firstChild);\n    }\n\n    for (x = 0; x < awesomeArray.length; x++) {\n      var times = awesomeArray[x];\n      var curstart = times[0];\n      var curend = times[1];\n      curstartString = String(curstart);\n      curendString = String(curend); // createPrettyList(curstart, curend);\n      // appendPre(\"[inputDate]: \" + curstart + \" to \" + curend);\n      //\n\n      startstring = curstart.toLocaleString('en-US', {\n        timeZone: 'EST',\n        timeStyle: \"short\",\n        dateStyle: \"short\"\n      });\n      endstring = curend.toLocaleString('en-US', {\n        timeZone: 'EST',\n        timeStyle: \"short\",\n        dateStyle: \"short\"\n      });\n      startstringsplit = curstartString.split(\" \");\n      pretty_dayofweek = startstringsplit[0];\n      month = curstart.getMonth() + 1;\n      day = curstart.getDate();\n      startstringsplit2 = startstring.split(\" \");\n      pretty_starttime = startstringsplit2[1] + \" \" + startstringsplit2[2];\n      endstringsplit2 = endstring.split(\" \");\n      pretty_endtime = endstringsplit2[1] + \" \" + endstringsplit2[2];\n      prettystring = pretty_dayofweek + \" \" + month + \"/\" + day + \": \" + pretty_starttime + \" to \" + pretty_endtime;\n      console.log(prettystring);\n      var node = document.createElement(\"LI\"); //var textnode = document.createTextNode(\"[inputDate]: \" + curstart +  \" to \" + curend);\n\n      var textnode = document.createTextNode(prettystring);\n      node.appendChild(textnode);\n      document.getElementById(\"myList\").appendChild(node);\n    }\n  } //   fetchTest()\n\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"todo-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n      children: \"Selected calendars: \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 637,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 638,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      className: \"todo-list\",\n      children: props.selectedCalendars.map((cal, index, originalArray) => {\n        return /*#__PURE__*/_jsxDEV(\"li\", {\n          children: cal\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 644,\n          columnNumber: 17\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 640,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [\"hi \", format(props.startDate, \"MM-dd-yyyy\")]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 649,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 650,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 651,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: fetchTest,\n      children: \" fetch here \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 652,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 636,\n    columnNumber: 5\n  }, this);\n};\n\n_c = CalendarOutput;\nexport default CalendarOutput;\n\nvar _c;\n\n$RefreshReg$(_c, \"CalendarOutput\");","map":{"version":3,"names":["React","Calendar","format","CalendarOutput","props","allStartTimes","allEndTimes","busyBlocksToAdd","fetchTest","start","Date","startDate","setHours","setMinutes","setSeconds","toISOString","end","console","log","request","timeMin","timeMax","timeZone","cals","i","selectedCalendars","length","calObj","id","push","items","num_days","endDate","getDate","x","day","curDateDay","inputDate","morningBusyStart","setDate","setFullYear","getFullYear","morningBusyEnd","nightBusyStart","nightBusyEnd","morningBusyStart_formatted","date","morningBusyEnd_formatted","nightBusyStart_formatted","nightBusyEnd_formatted","timecombo","freeRequest","gapi","client","calendar","freebusy","query","then","response","result","k","curCal","busyTimes","calendars","busy","busyBlock","startTime","endTime","data","data2","consolidateAllBusyTimes","err","error","sort","a","b","c","d","startTimes","endTimes","masterArray","timeStartDateFormat","timeEndDateFormat","prettyStartTime","toLocaleString","prettyEndTime","start2","end2","newtimes","curstart","getTime","curend","latestend","newtime","shouldWeAddIt","newertimes","shouldAdd","newesttimes","removedtimes","finaltimes","allstarttimes3","allendtimes3","finalmasterArray","printPrettyTimeslots","awesomeArray","diff","beginfreeslot","endfreeslot","prettyStart","prettyEnd","times","nextstart","nextend","eightAm","splitStart","split","splitEnd","ogStart","ogEnd","sevenPm","thelist","document","getElementById","firstChild","removeChild","curstartString","String","curendString","startstring","timeStyle","dateStyle","endstring","startstringsplit","pretty_dayofweek","month","getMonth","startstringsplit2","pretty_starttime","endstringsplit2","pretty_endtime","prettystring","node","createElement","textnode","createTextNode","appendChild","map","cal","index","originalArray"],"sources":["/Users/tucker/Documents/GitHub/tmb5cg.github.io/src/components/FreeTimeFinder/CalendarOutput.js"],"sourcesContent":["import React from 'react';\nimport Calendar from './Calendar.js'\nimport format from \"date-fns/format\";\n\nconst CalendarOutput = (props) => {\n\n    const allStartTimes = [];\n    const allEndTimes = [];\n    const busyBlocksToAdd = [];\n\n    const fetchTest = () => {\n        // Format start date to 8am\n        var start = new Date(props.startDate)\n        start.setHours(8)\n        start.setMinutes(0)\n        start.setSeconds(0)\n        start = start.toISOString();\n\n        // Format end date to 8 pm\n        var end = new Date(props.startDate)\n        end.setHours(20)\n        end.setMinutes(0)\n        end.setSeconds(0)\n        end = end.toISOString();\n        \n        console.log(start)\n        console.log(end)\n\n        // Build request body\n        const request = {}\n        request.timeMin = start;\n        request.timeMax = end;\n        request.timeZone = \"EST\";\n\n        // Create calendars object\n        let cals = []\n        for (let i=0; i<props.selectedCalendars.length; i++){\n            let calObj = {}\n            calObj.id = props.selectedCalendars[i]\n            cals.push(calObj)\n        }\n\n        request.items = cals\n\n\n        let num_days = props.endDate.getDate() - props.startDate.getDate()\n\n        // for each day in between input dates, add event\n        // day1 8am 830am, 8pm to day2 8am\n        for (let x=0; x < num_days; x++){\n            day = props.startDate.getDate()\n\n            curDateDay = day + x\n            inputDate = props.startDate\n\n            //appendPre(curDateDay)\n            morningBusyStart = new Date()\n            morningBusyStart.setDate(curDateDay)\n            morningBusyStart.setHours(8)\n            morningBusyStart.setMinutes(0)\n            morningBusyStart.setSeconds(0)\n            morningBusyStart.setFullYear(inputDate.getFullYear())\n\n            morningBusyEnd = new Date()\n            morningBusyEnd.setDate(curDateDay)\n            morningBusyEnd.setHours(8)\n            morningBusyEnd.setMinutes(30)\n            morningBusyEnd.setSeconds(0)\n            morningBusyEnd.setFullYear(inputDate.getFullYear())\n\n\n            nightBusyStart = new Date()\n            nightBusyStart.setDate(curDateDay)\n            nightBusyStart.setHours(20)\n            nightBusyStart.setMinutes(0)\n            nightBusyStart.setSeconds(0)\n            nightBusyStart.setFullYear(inputDate.getFullYear())\n\n            nightBusyEnd = new Date()\n            nightBusyEnd.setDate(curDateDay)\n            nightBusyEnd.setHours(20)\n            nightBusyEnd.setMinutes(30)\n            nightBusyEnd.setSeconds(0)\n            nightBusyEnd.setFullYear(inputDate.getFullYear())\n\n            // prettyStartTime = morningBusyStart.toLocaleString('en-US', { timeZone: 'EST' });\n            // prettyEndTime = morningBusyEnd.toLocaleString('en-US', { timeZone: 'EST' });\n            var morningBusyStart_formatted = {date: morningBusyStart};\n            var morningBusyEnd_formatted = {date: morningBusyEnd};\n\n            var nightBusyStart_formatted = {date: nightBusyStart};\n            var nightBusyEnd_formatted = {date: nightBusyEnd};\n\n            allStartTimes.push(morningBusyStart_formatted);\n            allEndTimes.push(morningBusyEnd_formatted);\n\n            allStartTimes.push(nightBusyStart_formatted);\n            allEndTimes.push(nightBusyEnd_formatted);\n\n            timecombo = [morningBusyStart, morningBusyEnd];\n            busyBlocksToAdd.push(timecombo);\n\n        }\n        return freeRequest = gapi.client.calendar.freebusy.query(request)\n      \n              .then(function(response) {\n                console.log(\"Frebusy response: \", response);\n                console.log(\"Frebusy response2: \", response.result);\n\n                for (let k = 0; k < props.selectedCalendars.length; k++) {\n                    var curCal = props.selectedCalendars[k];\n                    console.log(\"Current calendar: \", curCal);\n                    console.log(\"Iteration: k = \" + k)\n        \n                    var busyTimes = response.result.calendars[curCal].busy;\n        \n                    for (let i = 0; i < busyTimes.length; i++){\n                      var busyBlock = busyTimes[i];\n                      console.log(\"Busy block for \" + curCal, busyBlock);\n        \n                      var startTime = busyBlock.start;\n                      var endTime = busyBlock.end;\n        \n                      var data = {date: startTime};\n                      var data2 = {date: endTime};\n        \n                      allStartTimes.push(data);\n                      allEndTimes.push(data2);\n        \n                    }\n                  }\n                consolidateAllBusyTimes();\n                // console.log(allStartTimes)\n                // console.log(allEndTimes)\n                // console.log(busyBlocksToAdd)\n              },\n              function(err) { console.error(\"Execute error\", err); });\n      }\n\n\n      const consolidateAllBusyTimes = () => {\n        allStartTimes.sort(function(a, b) {\n          var c = new Date(a.date);\n          var d = new Date(b.date);\n          return c-d;\n      });\n  \n      //    appendPre(\"- - - - - - - Sorting end times\")\n  \n      allEndTimes.sort(function(a, b) {\n        var c = new Date(a.date);\n        var d = new Date(b.date);\n        return c-d;\n      });\n  \n        let startTimes = allStartTimes;\n        let endTimes = allEndTimes;\n\n      var masterArray = [];\n        for (let x = 0; x < startTimes.length; x++){\n          let startTime = startTimes[x].date;\n          let endTime = endTimes[x].date;\n  \n          let timeStartDateFormat = new Date(startTime);\n          let timeEndDateFormat = new Date(endTime);\n  \n          let prettyStartTime = timeStartDateFormat.toLocaleString('en-US', { timeZone: 'EST' });\n          let prettyEndTime = timeEndDateFormat.toLocaleString('en-US', { timeZone: 'EST' });\n  \n          let timecombo = [timeStartDateFormat, timeEndDateFormat];\n          masterArray.push(timecombo);\n        }\n        // print OG array\n      // // //\n      console.log(\"Original array\");\n        for (let k=0; k<masterArray.length;k++){\n          let data = masterArray[k];\n          let start = data[0];\n          let end = data[1];\n  \n          let start2 = new Date(start).toLocaleString('en-US', { timeZone: 'EST' });\n          let end2 = new Date(end).toLocaleString('en-US', { timeZone: 'EST' });\n  \n          console.log(k + \" Start: \" + start2 + \" || End: \" + end2);\n        }\n        // STEP 1 merge all same start times\n        var newtimes = [];\n        for (let x = 0; x < masterArray.length; x++){\n              var data = masterArray[x];\n  \n              var curstart = data[0].getTime();\n              var curend = data[1].getTime();\n  \n              var latestend = curend;\n  \n              for (let i = 0; i < masterArray.length; i++){\n                var data2 = masterArray[i];\n  \n                var start2 = data2[0].getTime();\n                var end2 = data2[1].getTime();\n                if (curstart == start2) {\n                      if (latestend < end2) {\n                        latestend = end2;\n                      }\n                }\n              }\n  \n              let newtime = [curstart, latestend];\n  \n              var shouldWeAddIt = true;\n              for (let k=0; k<newtimes.length;k++){\n                let data = newtimes[k];\n                let start = data[0];\n                let end = data[1];\n  \n                if (start == curstart){\n                  if (end == latestend) {\n                    shouldWeAddIt = false;\n                  }\n                } else {\n                }\n              }\n  \n              if (shouldWeAddIt){\n                newtimes.push(newtime);\n              }\n          }\n  \n          // print OG array\n        //\n      //  appendPre(\"Merging same start times\");\n          for (let k=0; k<newtimes.length;k++){\n            let data = newtimes[k];\n            let start = data[0];\n            let end = data[1];\n  \n            start2 = new Date(start).toLocaleString('en-US', { timeZone: 'EST' });\n            end2 = new Date(end).toLocaleString('en-US', { timeZone: 'EST' });\n  \n            //appendPre(k + \" Start: \" + start2 + \" || End: \" + end2);\n          }\n  \n        // STEP 2  Remove times within larger time blocks\n        var newertimes = [];\n        for (let x = 0; x < newtimes.length; x++){\n              var data = newtimes[x];\n  \n              var curstart = data[0]\n              var curend = data[1]\n              var latestend = curend;\n  \n              var shouldAdd = true;\n              for (let i = 0; i < newtimes.length; i++){\n                var data2 = newtimes[i];\n                var start2 = data2[0]\n                var end2 = data2[1]\n  \n                if (start2 < curstart) {\n                  if (end2 > curend){\n                    shouldAdd = false;\n                  }\n                }\n  \n              }\n  \n              let newtime = [curstart, curend];\n  \n              if (shouldAdd) {\n                newertimes.push(newtime);\n              }\n          }\n  \n  \n              // STEP 2 printing results\n            //  appendPre(\"TIMES WITH OVERLAPPING BLOCKS REMOVED: \" + newertimes);\n              for (let k=0; k<newertimes.length;k++){\n                data = newertimes[k];\n                let start = data[0];\n                let end = data[1];\n  \n                let start2 = new Date(start).toLocaleString('en-US', { timeZone: 'EST' });\n                let end2 = new Date(end).toLocaleString('en-US', { timeZone: 'EST' });\n  \n              }\n  \n          // STEP  3 FINAL STEP - consolidate back to back events\n          var newesttimes = [];\n          var removedtimes = [];\n          for (let x = 0; x < newertimes.length; x++){\n                var data = newertimes[x];\n  \n                var curstart = data[0];\n                var curend = data[1];\n  \n                for (let i = 0; i < newertimes.length; i++){\n                  var data2 = newertimes[i];\n  \n                  var start2 = data2[0];\n                  var end2 = data2[1];\n  \n                  if (curend > start2){\n                    if (curend < end2) {\n                      let newtime = [curstart, end2];\n                      newesttimes.push(newtime);\n                      removedtimes.push([curstart,curend]);\n                      removedtimes.push([start2, end2]);\n                    }\n                  }\n            }\n          }\n  \n              // STEP 3 printing results\n              for (let k=0; k<newesttimes.length; k++){\n                data = newesttimes[k];\n                let start = data[0];\n                let end = data[1];\n  \n                let start2 = new Date(start).toLocaleString('en-US', { timeZone: 'EST' });\n                let end2 = new Date(end).toLocaleString('en-US', { timeZone: 'EST' });\n  \n              }\n  \n              // more printing results\n              for (let k=0; k<removedtimes.length; k++){\n                data = removedtimes[k];\n                let start = data[0];\n                let end = data[1];\n  \n                let start2 = new Date(start).toLocaleString('en-US', { timeZone: 'EST' });\n                let end2 = new Date(end).toLocaleString('en-US', { timeZone: 'EST' });\n              }\n  \n            // Adding consolidated times together, finishing up etc\n            var finaltimes = [];\n            for (let k=0; k < newertimes.length; k++){\n              data = newertimes[k];\n              let start = data[0];\n              let end = data[1];\n  \n              var shouldWeAddIt = true;\n  \n              for (let x=0; x < removedtimes.length; x++){\n                    let data2 = removedtimes[x];\n                    let start2 = data2[0];\n                    let end2 = data2[1];\n  \n                    if (start2 == start) {\n                      if (end2 == end) {\n                        shouldWeAddIt = false;\n                      }\n                      }\n                }\n  \n              if (shouldWeAddIt == true) {\n                finaltimes.push(data);\n              }\n           }\n  \n         for (let k=0; k<finaltimes.length; k++){\n           data = finaltimes[k];\n           let start = data[0];\n           let end = data[1];\n  \n           let start2 = new Date(start).toLocaleString('en-US', { timeZone: 'EST' });\n           let end2 = new Date(end).toLocaleString('en-US', { timeZone: 'EST' });\n  \n         }\n  \n         for (let k=0; k<newesttimes.length; k++){\n           let data = newesttimes[k];\n           finaltimes.push(data);\n         }\n  \n         for (let k=0; k<finaltimes.length; k++){\n           data = finaltimes[k];\n           let start = data[0];\n           let end = data[1];\n  \n           let start2 = new Date(start).toLocaleString('en-US', { timeZone: 'EST' });\n           let end2 = new Date(end).toLocaleString('en-US', { timeZone: 'EST' });\n  \n         }\n  \n         var allstarttimes3 = [];\n         var allendtimes3 = [];\n         for (let k=0; k<finaltimes.length; k++){\n           data = finaltimes[k];\n           let start = data[0];\n           let end = data[1];\n  \n           allstarttimes3.push(start);\n           allendtimes3.push(end);\n         }\n  \n        allstarttimes3.sort(function(a, b){return a-b});\n        allendtimes3.sort(function(a, b){return a-b});\n  \n        var finalmasterArray = [];\n  \n          for (let x = 0; x < allstarttimes3.length; x++){\n            let startTime = allstarttimes3[x];\n            let endTime = allendtimes3[x];\n  \n            let timeStartDateFormat = new Date(startTime);\n            let timeEndDateFormat = new Date(endTime);\n  \n            let prettyStartTime = timeStartDateFormat.toLocaleString('en-US', { timeZone: 'EST' });\n            let prettyEndTime = timeEndDateFormat.toLocaleString('en-US', { timeZone: 'EST' });\n  \n            let timecombo = [timeStartDateFormat, timeEndDateFormat];\n            finalmasterArray.push(timecombo);\n          }\n  \n          printPrettyTimeslots(allstarttimes3, allendtimes3, finalmasterArray);\n  \n    }\n\n    function printPrettyTimeslots(allstarttimes3, allendtimes3, finalmasterArray){\n        var awesomeArray = [];\n        let diff = ''\n        let beginfreeslot = ''\n        let endfreeslot = ''\n        let prettyStart = ''\n        let prettyEnd = ''\n        let prettyStartTime = ''\n        let prettyEndTime = ''\n        for (let x = 0; x < finalmasterArray.length-1; x++){\n              var times = finalmasterArray[x];\n              var curstart = times[0];\n              var curend = times[1];\n    \n              var times = finalmasterArray[x+1];\n    \n              var nextstart = times[0];\n              var nextend = times[1];\n    \n    \n              if (x==0) {\n                // First element, subtract from 8am\n                let eightAm = new Date(curstart);\n    \n                eightAm.setHours(8);\n                eightAm.setMinutes(0);\n                eightAm.setSeconds(0);\n    \n                eightAm = eightAm.getTime();\n                eightAm = new Date(eightAm);\n    \n                let diff = curstart - eightAm;\n    \n                if ((diff > 0) && (diff < 36000000)) {\n                  let beginfreeslot = eightAm;\n                  eightAm = eightAm.getTime();\n                  let endfreeslot = eightAm + diff;\n    // console.log(\"morning begin free slot (should be 8am): \" + beginfreeslot);\n    // console.log(\"morning diff should be 30 mins: \" + diff);\n    //\n    // console.log(\"morning end free slot (should be 830am): \" + endfreeslot);\n                  let prettyStart = new Date(beginfreeslot);\n                  let prettyEnd = new Date(endfreeslot);\n    \n                  let prettyStartTime = prettyStart.toLocaleString('en-US', { timeZone: 'EST' });\n                  let prettyEndTime = prettyEnd.toLocaleString('en-US', { timeZone: 'EST' });\n    \n                  let splitStart = prettyStartTime.split(\" \");\n                  let splitEnd = prettyEndTime.split(\" \");\n    \n                  let ogStart = splitStart[1];\n                  let ogEnd = splitEnd[1];\n                  awesomeArray.push([prettyStart, prettyEnd]);\n                }\n    \n    \n    \n                // final else statement is skipped on first element due to bad code\n                // copying and pasting the else so it will hit, then it will\n                // add the end time\n                diff = nextstart - curend;\n    \n                if ((diff > 0) && (diff < 36000000)) {\n                  let beginfreeslot = curend;\n                  let endfreeslot = nextstart + diff;\n                  console.log(\"correct begin free slot: \" + beginfreeslot);\n                  console.log(\"correct diff \" + diff);\n    \n                  console.log(\"correct end slot: \" + endfreeslot);\n                  let prettyStart = new Date(beginfreeslot);\n                  let prettyEnd = new Date(endfreeslot);\n    \n                  let prettyStartTime = prettyStart.toLocaleString('en-US', { timeZone: 'EST' });\n                  let prettyEndTime = prettyEnd.toLocaleString('en-US', { timeZone: 'EST' });\n    \n                  let splitStart = prettyStartTime.split(\" \");\n                  let splitEnd = prettyEndTime.split(\" \");\n    \n                  let ogStart = splitStart[1];\n                  let ogEnd = splitEnd[1];\n                  awesomeArray.push([prettyStart, prettyEnd]);\n                }\n    \n              }\n    \n              else if (x == finalmasterArray.length-2){\n                // final else statement is skipped on last element due to bad code\n                // copying and pasting the else so it will hit, then it will\n                // add the end time\n                diff = nextstart - curend;\n    \n                  if ((diff > 0) && (diff < 36000000)) {\n                  let beginfreeslot = curend;\n                  let endfreeslot = nextstart + diff;\n                  console.log(\"correct begin free slot: \" + beginfreeslot);\n                  console.log(\"correct diff \" + diff);\n    \n                  console.log(\"correct end slot: \" + endfreeslot);\n                  let prettyStart = new Date(beginfreeslot);\n                  let prettyEnd = new Date(endfreeslot);\n    \n                  let prettyStartTime = prettyStart.toLocaleString('en-US', { timeZone: 'EST' });\n                  let prettyEndTime = prettyEnd.toLocaleString('en-US', { timeZone: 'EST' });\n    \n                  let splitStart = prettyStartTime.split(\" \");\n                  let splitEnd = prettyEndTime.split(\" \");\n    \n                  let ogStart = splitStart[1];\n                  let ogEnd = splitEnd[1];\n                  awesomeArray.push([prettyStart, prettyEnd]);\n                }\n    \n                // Proceed to add final end of day -> 8 pm time slot\n                let sevenPm = new Date(curend);\n    \n                sevenPm.setHours(8+12);\n                sevenPm.setMinutes(0);\n                sevenPm.setSeconds(0);\n    \n                nextend = nextend.getTime()\n    \n                diff = sevenPm - nextend;\n    \n                if ((diff > 0) && (diff < 36000000)) {\n                  // nextend = nextend.getTime()\n                  beginfreeslot = nextend;\n                  endfreeslot = nextend + diff;\n    \n                  prettyStart = new Date(beginfreeslot);\n                  prettyEnd = new Date(endfreeslot);\n    \n                  prettyStartTime = prettyStart.toLocaleString('en-US', { timeZone: 'EST' });\n                  prettyEndTime = prettyEnd.toLocaleString('en-US', { timeZone: 'EST' });\n    \n                  splitStart = prettyStartTime.split(\" \");\n                  splitEnd = prettyEndTime.split(\" \");\n    \n                  ogStart = splitStart[1];\n                  ogEnd = splitEnd[1];\n                  awesomeArray.push([prettyStart, prettyEnd]);\n                }\n    \n    \n              }\n              else {\n                  let diff = nextstart - curend;\n    \n                  if ((diff > 0) && (diff < 36000000)) {\n                    beginfreeslot = curend;\n                    endfreeslot = nextstart + diff;\n                    console.log(\"correct begin free slot: \" + beginfreeslot);\n                    console.log(\"correct diff \" + diff);\n    \n                    console.log(\"correct end slot: \" + endfreeslot);\n                    prettyStart = new Date(beginfreeslot);\n                    prettyEnd = new Date(endfreeslot);\n    \n                    prettyStartTime = prettyStart.toLocaleString('en-US', { timeZone: 'EST' });\n                    prettyEndTime = prettyEnd.toLocaleString('en-US', { timeZone: 'EST' });\n    \n                    splitStart = prettyStartTime.split(\" \");\n                    splitEnd = prettyEndTime.split(\" \");\n    \n                    ogStart = splitStart[1];\n                    ogEnd = splitEnd[1];\n                    awesomeArray.push([prettyStart, prettyEnd]);\n                  }\n                }\n        }\n    \n        // Remove old elements in list\n        thelist = document.getElementById(\"myList\");\n        while( thelist.firstChild ){\n          thelist.removeChild( thelist.firstChild );\n        }\n        for (x = 0; x < awesomeArray.length; x++){\n          var times = awesomeArray[x];\n          var curstart = times[0];\n          var curend = times[1];\n    \n          curstartString = String(curstart);\n          curendString = String(curend);\n          // createPrettyList(curstart, curend);\n          // appendPre(\"[inputDate]: \" + curstart + \" to \" + curend);\n    //\n    \n          startstring = curstart.toLocaleString('en-US', { timeZone: 'EST',  timeStyle: \"short\", dateStyle: \"short\" });\n          endstring = curend.toLocaleString('en-US', { timeZone: 'EST',  timeStyle: \"short\", dateStyle: \"short\" });\n    \n          startstringsplit = curstartString.split(\" \");\n          pretty_dayofweek = startstringsplit[0]\n          month = curstart.getMonth() + 1;\n          day = curstart.getDate();\n    \n          startstringsplit2 = startstring.split(\" \");\n          pretty_starttime = startstringsplit2[1] + \" \" + startstringsplit2[2];\n          endstringsplit2 = endstring.split(\" \");\n          pretty_endtime = endstringsplit2[1] + \" \" + endstringsplit2[2];\n    \n          prettystring = (pretty_dayofweek + \" \" + month + \"/\" + day + \": \" + pretty_starttime + \" to \" + pretty_endtime);\n          console.log(prettystring);\n    \n    \n          var node = document.createElement(\"LI\");\n          //var textnode = document.createTextNode(\"[inputDate]: \" + curstart +  \" to \" + curend);\n          var textnode = document.createTextNode(prettystring)\n          node.appendChild(textnode);\n          document.getElementById(\"myList\").appendChild(node);\n    \n        }\n    }\n      \n\n    \n\n    //   fetchTest()\n\n     return (\n    <div className=\"todo-container\">\n    <h4>Selected calendars: </h4>\n    <br />\n\n    <ul className='todo-list'>\n    {\n        props.selectedCalendars.map((cal, index, originalArray) => {\n            return (\n                <li>{cal}</li>\n            )\n        })\n    }\n    </ul>\n    <h2>hi {format(props.startDate, \"MM-dd-yyyy\")}</h2>\n    <br />\n    <br />\n    <button onClick={fetchTest}> fetch here </button>\n\n    </div>\n\n     );\n}\n\nexport default CalendarOutput;"],"mappings":"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"},"metadata":{},"sourceType":"module"}